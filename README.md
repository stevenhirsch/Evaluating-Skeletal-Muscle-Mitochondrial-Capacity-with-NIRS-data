# Evaluating Skeletal Muscle Mitochondrial Capacity with NIRS data

Physiology researchers and other applied scientists are interested in assessing muscle mitochondrial function to understand muscle health and disease. Usually, this assessment is performed by surgically removing muscle tissue samples, and mitochondrial enzymes are used as a proxy for mitochondrial function.

In addition to being an invasive and costly procedure, another limitation of this method is that mitochondrial function would be inferred from limited samples. A solution to these limitations is to leverage advances in Near-Infrared Optical Spectroscopy (NIRS) technology. These devices have been used to measure various physiological markers such as muscle blood flow and perfusion, muscle oxygen consumption, and muscle oxygenation. You can also find this technology in most modern smart watches or other fitness wearables. NIRS works by measuring the oxygen-dependent absorption of NIR light by haemoglobin/myoglobin.

One specific use of NIRS technology in the physiology literature is to assess the recovery of muscle oxygenation following exercise as a proxy for its oxidative capacity. Briefly, experimental protocols will typically consist of two measurements of resting oxygen muscle consumption after inflating a blood pressure cuff to occlude the artery. Muscle oxygen consumption is then calculated as the slope of the measured deoxygenated haeomoglobin signal during arterial occlusion using linear regression. After resting measurements, recovery kinetics are assessed following a short duration constractions (to increase muscle oxygen consumption). The recovery kinetics of muscle oxygen consumption following the brief exertion are assessed using a series of short-duration arterial occlusions (e.g., 5s on/5s off for first 5 occlusions, and then the next five occlusions may use 7s on/7s off) and post-exercise muscle oxygen consumption is calculated at each occlusion using, again, linear regression. 

After collecting this post-exercise muscle oxygen consumption data (which is usually normalized with an ischaemic calibration & corrected for blood volume), an exponential function is fit to determine an index of mitochondrial oxidation capacity. The function is as follows: 

<img src="https://render.githubusercontent.com/render/math?math=y = (end-\Delta)\times e^{-kt}">

where y is the relative muscle oxygen consumption during the arterial occlusion, end is the muscle oxygen consumption immediately following exercise, delta is the change in muscle oxygen consumption from rest to end-exercise, t is time, and k is the fitting rate constant (the index of mitochondrial respiratory capacity).

The following code automates these analyses using Python. It assumes that you have an excel file exported from your NIRS software (like in the example provided) and automatically exports plots of the fitting rate constant (k_value_plot.pdf), total haeomoglobin and myoglobin (tHB.pdf), oxygenation haeomoglobin and myoglobin (o2Hb.pdf), deoxygenated haemoglobin and myoglobin (HHb.pdf), ischaemically calibrated o2Hb and HHb, blood-volume corrected o2Hb and HHb, as well as csv files containing the average o2Hb and HHb slopes at rest (slopes_resting.csv) and a timeseries containing blood-volume corrected and ischaemically calibrated o2Hb and HHb data (corrected_data.csv).
